(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[362],{4714:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/sk-admin",function(){return t(8829)}])},8829:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return A}});var r=t(5893),i=t(9008),s=t(7294),a=t(8822),o=t(2395),l=t.n(o),c=function(){var e=(0,s.useContext)(a.ZP),n=(0,s.useRef)(null),t=(0,s.useRef)(null);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h1",{children:"\ud83d\udc51"}),(0,r.jsx)("h2",{className:l().heading,children:"The King must log in"}),(0,r.jsxs)("form",{className:l().form,onSubmit:function(r){r.preventDefault(),e.login(n.current.value,t.current.value)},children:[(0,r.jsx)("label",{htmlFor:"email",children:"Email"}),(0,r.jsx)("input",{type:"email",id:"email",ref:n}),(0,r.jsx)("label",{htmlFor:"name",children:"Password"}),(0,r.jsx)("input",{type:"password",id:"password",ref:t}),(0,r.jsx)("p",{className:"error",children:e.message}),(0,r.jsx)("section",{children:(0,r.jsx)("button",{className:l().primary,children:"Login"})})]})]})},u=t(1043),d=u.v9,m=t(569),h=t(5707),f=t.n(h),x=function(e){var n=(0,s.useRef)(null),t=(0,s.useRef)(null),i=(0,s.useRef)(null),a=(0,s.useRef)(null),o=(0,s.useRef)(null),l=(0,s.useState)(""),c=l[0],u=l[1],d=(0,s.useState)(""),h=d[0],x=d[1],p=(0,s.useState)(""),j=p[0],v=p[1],_=(0,s.useState)(""),g=_[0],b=_[1],N=(0,s.useState)(""),y=N[0],S=N[1];(0,s.useEffect)((function(){n.current.value=e.item.name,t.current.value=e.item.date.toISOString().substring(0,10),i.current.value=e.item.people.toString(),a.current.value=e.item.kilograms.toString(),o.current.value=e.item.postcode.toString()}),[]);return(0,r.jsxs)("form",{className:f().form,onSubmit:function(r){r.preventDefault();var s=n.current.value,l=new Date(t.current.value),c=parseInt(i.current.value),d=parseFloat(a.current.value),h=parseInt(o.current.value),f=!1;0==s.trim().length?(u("Name is required"),f=!0):u(""),isNaN(Date.parse(t.current.value))?(x("Invalid date. At least have a guess"),f=!0):x(""),isNaN(c)||c<1?(v("Surely at least one person ate"),f=!0):v(""),isNaN(d)||d<1?(b("People would have been very hungry without at least one kilogram of food"),f=!0):b(""),isNaN(h)||h<1e3?(S("That doesn't look like a postcode"),f=!0):S(""),f||e.save(new m.Z(e.item.id,s,l,c,d,h))},children:[(0,r.jsx)("label",{htmlFor:"name",children:"Name"}),(0,r.jsx)("input",{type:"text",id:"name",ref:n}),c&&(0,r.jsx)("div",{className:f().error,children:c}),(0,r.jsx)("label",{htmlFor:"date",children:"Date"}),(0,r.jsx)("input",{type:"date",id:"date",ref:t}),h&&(0,r.jsx)("div",{className:f().error,children:h}),(0,r.jsx)("label",{htmlFor:"people",children:"People"}),(0,r.jsx)("input",{type:"number",id:"people",ref:i}),j&&(0,r.jsx)("div",{className:f().error,children:j}),(0,r.jsx)("label",{htmlFor:"kilograms",children:"Kilograms"}),(0,r.jsx)("input",{type:"number",id:"kilograms",ref:a,step:"0.1"}),g&&(0,r.jsx)("div",{className:f().error,children:g}),(0,r.jsx)("label",{htmlFor:"postcode",children:"Postcode"}),(0,r.jsx)("input",{type:"number",id:"postcode",ref:o}),y&&(0,r.jsx)("div",{className:f().error,children:y}),(0,r.jsxs)("section",{className:f().buttons,children:[(0,r.jsx)("button",{className:"primary",children:"Save"}),(0,r.jsx)("button",{onClick:e.cancel,children:"Cancel"})]})]})},p=function(e){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h3",{children:"Add Event"}),(0,r.jsx)(x,{item:e.item,save:e.save,cancel:e.cancel})]})},j=t(7313),v=t.n(j),_=function(e){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:v().name,children:e.item.name}),(0,r.jsx)("div",{children:e.item.date.toLocaleDateString()}),(0,r.jsxs)("div",{className:v().right,children:[e.item.people.toLocaleString(),"p"]}),(0,r.jsxs)("div",{className:v().right,children:[e.item.kilograms.toLocaleString(),"kg"]}),(0,r.jsx)("div",{className:v().right,children:e.item.postcode}),(0,r.jsxs)("div",{children:[(0,r.jsx)("a",{className:v().editLink,href:"#",onClick:function(n){e.onEdit(e.item)},children:"Edit"}),(0,r.jsx)("a",{className:v().editLink,href:"#",onClick:function(n){e.onDelete(e.item)},children:"Delete"})]})]})},g=t(3249),b=t(8100),N=t.n(b),y=function(e){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h3",{children:"Edit Event"}),(0,r.jsx)(x,{item:e.item,save:e.save,cancel:e.cancel})]})},S=function(e){return console.log("EventSummary"),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{children:"TOTAL"}),(0,r.jsxs)("div",{children:[e.items.length," events"]}),(0,r.jsxs)("div",{className:v().right,children:[e.items.map((function(e){return e.people})).reduce((function(e,n){return e+n}),0).toLocaleString(),"p"]}),(0,r.jsxs)("div",{className:v().right,children:[e.items.map((function(e){return e.kilograms})).reduce((function(e,n){return e+n}),0).toLocaleString(),"kg"]}),(0,r.jsx)("div",{className:v().right,children:e.items.map((function(e){return e.postcode})).reduce((function(e,n){return e.add(n)}),new Set).size}),(0,r.jsx)("div",{})]})};function k(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function E(e){return function(e){if(Array.isArray(e))return k(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return k(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return k(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var w=function(){var e=(0,s.useState)(!1),n=e[0],t=e[1],i=(0,s.useState)(null),a=i[0],o=i[1],l=d((function(e){return e.event.events})),c=(0,u.I0)(),h=function(e){o(e)},f=function(e){window.confirm("Do you wish to delete the event '".concat(e.name,"'?"))&&c((0,g.Jt)(e))},x=function(){t(!1),o(null)};(0,s.useEffect)((function(){c((0,g.QG)())}),[]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h2",{children:"Events"}),(0,r.jsx)("p",{children:"Numbers in this list are aggregated into a summary on the Spit King home-page"}),!n&&!a&&(0,r.jsx)("button",{onClick:function(){t(!0)},children:"Add Event"}),n&&(0,r.jsx)(p,{item:m.Z.blank(),save:function(e){c((0,g.Xh)(e)),x()},cancel:x}),a&&(0,r.jsx)(y,{item:a,save:function(e){c((0,g.WT)(e)),x()},cancel:x}),!n&&!a&&function(){var e=E(l).sort((function(e,n){return n.date.getTime()-e.date.getTime()}));return(0,r.jsxs)("div",{className:N().table,children:[(0,r.jsx)(S,{items:l}),e.map((function(e){return(0,r.jsx)(_,{item:e,onEdit:h,onDelete:f},e.id)}))]})}()]})},L=t(214),F=t.n(L),A=function(){var e=(0,s.useContext)(a.ZP).authenticated;return(0,r.jsxs)("div",{className:F().container,children:[(0,r.jsxs)(i.default,{children:[(0,r.jsx)("title",{children:"Spit King - Website Admin"}),(0,r.jsx)("meta",{name:"description",content:"Generated by create next app"}),(0,r.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,r.jsx)("header",{children:(0,r.jsx)("h1",{className:F().title,children:"Spit King - Website Admin"})}),(0,r.jsxs)("main",{className:F().main,children:[!e&&(0,r.jsx)(c,{}),e&&(0,r.jsx)(w,{})]}),(0,r.jsx)("footer",{className:F().footer})]})}},2395:function(e){e.exports={heading:"Login_heading__Qnh0u",form:"Login_form__t6ZO1",primary:"Login_primary__H2Ocb"}},5707:function(e){e.exports={form:"EventForm_form__X6yzW",error:"EventForm_error__bUAe8",buttons:"EventForm_buttons__hKjda"}},7313:function(e){e.exports={name:"EventItem_name__XiH2n",right:"EventItem_right__sTbC9",editLink:"EventItem_editLink__3KAVZ"}},8100:function(e){e.exports={table:"EventList_table__sWqjx"}},214:function(e){e.exports={container:"Home_container__bCOhY",main:"Home_main__nLjiQ",footer:"Home_footer____T7K",title:"Home_title__T09hD",description:"Home_description__41Owk",code:"Home_code__suPER",grid:"Home_grid__GxQ85",card:"Home_card___LpL1",logo:"Home_logo__27_tb"}},9008:function(e,n,t){e.exports=t(5443)}},function(e){e.O(0,[774,888,179],(function(){return n=4714,e(e.s=n);var n}));var n=e.O();_N_E=n}]);